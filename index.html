<!DOCTYPE html>
<html lang="nl">
<head>
    <!-- Vereiste meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Funny Christof Buffer App for children as seen on tv || very funny recipes for kids 3+ || parents love it">
    <meta name="msapplication-TileColor" content="#55b4da">
    <meta name="theme-color" content="#55b4da">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.ico" >
    <link rel="manifest" href="manifest.json" />
    <title>Home</title>

    <!-- Material.io bestanden (CSS & Font/icons)-->
    <!-- Uitleg werking componenents: https://material.io/components?platform=web -->
    <!-- Demo van components:         https://material-components.github.io/material-components-web-catalog/#/ -->
    <!-- Demo en uitleg icons:        https://fonts.google.com/icons?selected=Material+Icons -->
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <style>body{margin: 0;}</style>
    
    <!-- Material.io bestanden (JS en registratie componenten) -->
    <script src="libs/jquery.js"></script>
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <script>const MDCBanner = mdc.banner.MDCBanner;const MDCCheckbox = mdc.checkbox.MDCCheckbox;const MDCChip = mdc.chips.MDCChip;const MDCChipSet = mdc.chips.MDCChipSet;const MDCCircularProgress = mdc.circularProgress.MDCCircularProgress;const MDCDataTable = mdc.dataTable.MDCDataTable;const MDCDialog = mdc.dialog.MDCDialog;const MDCDrawer = mdc.drawer.MDCDrawer;const MDCFloatingLabel = mdc.floatingLabel.MDCFloatingLabel;const MDCFormField = mdc.formField.MDCFormField;const MDCIconButtonToggle = mdc.iconButton.MDCIconButtonToggle;const MDCLineRipple = mdc.lineRipple.MDCLineRipple;const MDCLinearProgress = mdc.linearProgress.MDCLinearProgress;const MDCList = mdc.list.MDCList;const MDCMenu = mdc.menu.MDCMenu;const MDCMenuSurface = mdc.menuSurface.MDCMenuSurface;const MDCNotchedOutline = mdc.notchedOutline.MDCNotchedOutline;const MDCRadio = mdc.radio.MDCRadio;const MDCRipple = mdc.ripple.MDCRipple;const MDCSegmentedButton = mdc.segmentedButton.MDCSegmentedButton;const MDCSelect = mdc.select.MDCSelect;const MDCSlider = mdc.slider.MDCSlider;const MDCSnackbar = mdc.snackbar.MDCSnackbar;const MDCSwitch = mdc.switchControl.MDCSwitch;const MDCTabBar = mdc.tabBar.MDCTabBar;const MDCTextField = mdc.textField.MDCTextField;const MDCTooltip = mdc.tooltip.MDCTooltip;const MDCTopAppBar = mdc.topAppBar.MDCTopAppBar;</script>
    <link rel="stylesheet" href="style.css">

</head>

<body>
    <!-- HTML web-elementen -->   
    <!-- Side menu-->
    <aside class="mdc-drawer mdc-drawer--modal">
        <img src="Resources/ChristofBuffer.png">
        <div class="mdc-drawer__header">
            <h3 class="mdc-drawer__title">Christof Cooking™</h3>
            <h6 class="mdc-drawer__subtitle">He will bring your grandma back to life</h6>
        </div>
        <div class="mdc-drawer__content">
        <nav class="mdc-list">
            <a class="mdc-list-item mdc-list-item--activated" href="#" aria-current="page">
            <span class="mdc-list-item__ripple"></span>
            <i class="material-icons mdc-list-item__graphic" aria-hidden="true">home</i>
            <span class="mdc-list-item__text">Home</span>
            </a>
            <a class="mdc-list-item chatButt" href="#">
            <span class="mdc-list-item__ripple"></span>
            <i class="material-icons mdc-list-item__graphic" aria-hidden="true">chat</i>
            <span class="mdc-list-item__text ">Chat</span>
            </a>
            <a class="mdc-list-item" href="#">
            <span class="mdc-list-item__ripple"></span>
            <i class="material-icons mdc-list-item__graphic" aria-hidden="true">person</i>
            <span class="mdc-list-item__text">Account</span>
            </a>
        </nav>
        </div>
    </aside>
    <div class="mdc-drawer-scrim"></div>

    <!--Header-->
    <header class="mdc-top-app-bar">
        <div class="mdc-top-app-bar__row">
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start navBar">
                <button class="material-icons mdc-top-app-bar__navigation-icon mdc-icon-button navButt" aria-label="Open navigation menu">menu</button>
                <button class="material-icons mdc-top-app-bar__navigation-icon mdc-icon-button closeMeme hidden" aria-label="Close meme">close</button>
                <span class="mdc-top-app-bar__title unselectable butt">Home</span>
            </section>
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start searchBar hidden">
              <label class="mdc-text-field mdc-text-field--filled mdc-text-field--no-label">
                <span class="mdc-text-field__ripple"></span>
                <input class="mdc-text-field__input" type="text" placeholder="Seach here" aria-label="Label" id="SearchBar">
                <span class="mdc-line-ripple"></span>
              </label>
            </section>
            <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-end" role="toolbar">
                <button class="material-icons mdc-top-app-bar__action-item mdc-icon-button searchButt" aria-label="search">search</button>
                <button class="material-icons mdc-top-app-bar__action-item mdc-icon-button" aria-label="Options">more_vert</button>
            </section>
        </div>
    </header>

    <!--Main Content-->
    <main class="mainContainer">
        <!--Tab Bar-->
        <div class="mdc-tab-bar" role="tablist">
            <div class="mdc-tab-scroller">
              <div class="mdc-tab-scroller__scroll-area">
                <div class="mdc-tab-scroller__scroll-content">
                  <button id="discoverTab" class="mdc-tab" role="tab" aria-selected="true" tabindex="0">
                    <span class="mdc-tab__content">
                      <span class="mdc-tab__text-label">Discover</span>
                    </span>
                    <span class="mdc-tab-indicator">
                      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                    </span>
                    <span class="mdc-tab__ripple"></span>
                  </button>
                  <button id="searchTab" class="mdc-tab" role="tab" aria-selected="true" tabindex="0">
                    <span class="mdc-tab__content">
                        <span class="mdc-tab__text-label">Search</span>
                    </span>
                    <span class="mdc-tab-indicator">
                      <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                    </span>
                    <span class="mdc-tab__ripple"></span>
                  </button>
                </div>
              </div>
            </div>
        </div>
        
        <div id="NoFind" >
          <img src="images/ChristofCooker.png" class="noFind">
        </div>
        <ul class="mdc-image-list mdc-image-list--masonry my-masonry-image-list" id="results">
        </ul>
    </main>

    <!--Sheet-->
    <span class="sheet sheet-out-of-view">
      <main>
        <img src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fimg.esa.io%2Fuploads%2Fproduction%2Fattachments%2F2352%2F2023%2F12%2F08%2F137977%2F29fd2f54-ce28-4e69-8e3b-b0df3cfe45f3.gif&f=1&nofb=1&ipt=57beb74cc41239fe879911dbcec0ffc9a3a46e05efb5ec6e3c68623a6ec14db4&ipo=images">
        <h3 id="SheetTitle" class="whiteText">Title</h3>
        <hr>
        <b id="ExtraInfo" class="whiteText"></b>
        <p id="SheetDescription" class="whiteText">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Temporibus, praesentium maiores exercitationem itaque consequuntur architecto?</p>
        <h4 class="whiteText">Ingredients: </h4>
        <ul id="SheetIngredients" clas="recipeList"></ul>
        <h4 class="whiteText">Instructions: </h4>
        <p id="SheetInstructions" class="whiteText">Lorem ipsum dolor sit amet consectetur adipisicing elit. Autem nobis pariatur dolore ex fuga. Eum!</p>
      </main>
      <!-- <footer>
        <button class="material-icons mdc-tab__icon mdc-icon-button" aria-label="Like">thumb_up</button>
        <button class="material-icons mdc-tab__icon mdc-icon-button" aria-label="Favorite">favorite</button>
        <button class="material-icons mdc-tab__icon mdc-icon-button" aria-label="Dislike">thumb_down</button>
      </footer> -->
    </span>
    <!--Chat-Sheet-->
    <span class="chat sheet-out-of-view">
      <main>
        <h3 id="SheetTitle" class="whiteText">Hello welcome to chating with Christof™</h3>
        <p id="SheetInstructions" class="whiteText">Leave your prayers here.</p>
        <ul id="Chat" class="chatList">
        </ul>
        
      </main>
      <footer>
        <label class="mdc-text-field mdc-text-field--filled mdc-text-field--no-label">
          <span class="mdc-text-field__ripple"></span>
          <input class="mdc-text-field__input" type="text" placeholder="Message" aria-label="Label" id="ChatInput">
          <span class="mdc-line-ripple"></span>
        </label>
      </footer>
    </span>

    
    
    <!--Vanaf hier custom Javascript-->
    <script>
        const topAppBarElement = document.querySelector('.mdc-top-app-bar');
        const homeButt = document.querySelector('.mdc-top-app-bar__title')
        const searchButt = document.querySelector('.searchButt')
        const topAppBar = new MDCTopAppBar(topAppBarElement);

        const drawer = MDCDrawer.attachTo(document.querySelector('.mdc-drawer'));
        const listEl = document.querySelector('.mdc-drawer .mdc-list');
        const tabBar = new MDCTabBar(document.querySelector('.mdc-tab-bar'));

        const masonry = document.querySelector('.my-masonry-image-list');

        let searchOpen = false;
        let sheetOpen = false;
        let chatOpen = false;
        let page = "Home";

        window.addEventListener("load", () => {
          if("serviceWorker" in navigator){
            navigator.serviceWorker.register("service-worker.js")
          }
          RandomRecipes(); //Hello I have been trying to reacht to you about your cars extended warranty it has to be as expanded as this sentence cuz you'll definetly forget to reanable this later :)
          $("#NoFind").addClass("hidden");
          setTab("discoverTab");
        });

        addEventListener("popstate", (event) => 
        { 
          console.log("pop")
          closeSheet()
        });

        homeButt.addEventListener('click', (event) => {
            let currentTab = document.querySelector('.mdc-tab--active')
            let indicator = document.querySelector('.mdc-tab-indicator--active')
            currentTab.classList.remove('mdc-tab--active')
            indicator.classList.remove('mdc-tab-indicator--active')
            openTab()
        });

        //Close Drawer
        listEl.addEventListener('click', (event) => {
            drawer.open = false;
        });
        //Open Drawer
        const listButt = document.querySelector('.navButt');
        listButt.addEventListener('click', (event) => {
            drawer.open = true;
        });
        

        //Sheet
        let images = document.querySelectorAll('.recipeImage');
        images.forEach(i =>{
          i.addEventListener('click', (event) => {
            openSheet(event);
          });
        });
        const closeMeme = document.querySelectorAll('.closeMeme');
        closeMeme.forEach(i =>{
          i.addEventListener('click', (event) => {
              closeSheet(event);
              closeChat(event);
          });
        });
        //Open sheet
        function openSheet(event = null)
        {
          if(sheetOpen) return
          sheetOpen = true;
          history.pushState(null, "", location.pathname+"#sheet");

          document.querySelector(".sheet").classList.toggle("sheet-out-of-view");
          document.querySelector(".closeMeme").classList.remove("hidden")
          document.querySelector(".mainContainer").classList.add("overflow")
          document.querySelector(".navButt").classList.add("hidden")

          if(event === null){return}
          loadMode()

          const target = event.target.parentElement
          getInfo(target.getElementsByTagName('p')[0].innerHTML)

          document.querySelector(".sheet img").setAttribute("src",event.srcElement.getAttribute("src"));
          document.querySelector(".mdc-top-app-bar__title").innerHTML = event.srcElement.getAttribute("title");
        }
        //Close Sheet
        function closeSheet(event = null)
        {
          if(!sheetOpen) return
          loadMode()
          sheetOpen = false;
          history.pushState(null, "", location.pathname);

          document.querySelector(".sheet").classList.toggle("sheet-out-of-view");
          document.querySelector(".closeMeme").classList.add("hidden")
          document.querySelector(".mainContainer").classList.remove("overflow")
          document.querySelector(".navButt").classList.remove("hidden")
          document.querySelector(".mdc-top-app-bar__title").innerHTML = page
        }
        //Set Sheet in load mode
        function loadMode()
        {
          $("#SheetTitle").text("loading")
          $("#SheetDescription").html("loading")
          $("#SheetIngredients").empty()
          $("#ExtraInfo").html(`loading m prep time - loading servings`)
          $("#SheetInstructions").html("loading")
        }


        //Chat
        let chatButt = document.querySelectorAll('.chatButt');
        chatButt.forEach(i =>{
          i.addEventListener('click', (event) => {
            openChat(event);
          });
        });
        

        //Open sheet
        function openChat(event = null)
        {
          if(chatOpen) return
          chatOpen = true;
          history.pushState(null, "", location.pathname+"#chat");
          console.log("Open Chat")

          document.querySelector(".chat").classList.toggle("sheet-out-of-view");
          document.querySelector(".closeMeme").classList.remove("hidden")
          document.querySelector(".mainContainer").classList.add("overflow")
          document.querySelector(".navButt").classList.add("hidden")
        }
        //Close Sheet
        function closeChat(event = null)
        {
          if(!chatOpen) return
          chatOpen = false;
          history.pushState(null, "", location.pathname);

          document.querySelector(".chat").classList.toggle("sheet-out-of-view");
          document.querySelector(".closeMeme").classList.add("hidden")
          document.querySelector(".mainContainer").classList.remove("overflow")
          document.querySelector(".navButt").classList.remove("hidden")
          document.querySelector(".mdc-top-app-bar__title").innerHTML = page
        }
        //Close all Sheets
        function closeAll()
        {
          history.pushState(null, "", location.pathname);
          if(chatOpen){
            document.querySelector(".chat").classList.add("sheet-out-of-view");
            chatOpen = false;
          } 
          if(sheetOpen) {
            document.querySelector(".sheet").classList.add("sheet-out-of-view");
            sheetOpen = false
          }
          if(sheetOpen || chatOpen){
            document.querySelector(".closeMeme").classList.add("hidden");
            document.querySelector(".mainContainer").classList.remove("overflow");
            document.querySelector(".navButt").classList.remove("hidden");
            document.querySelector(".mdc-top-app-bar__title").innerHTML = page;    
          }        
        }


        //Tab
        const tabButtons = document.querySelector('.mdc-tab-bar');
        tabButtons.addEventListener('click', (event) => {
          const tab = document.querySelector('.mdc-tab--active');
          if(tab === null){return;}
          const tabName = tab.querySelector(".mdc-tab__text-label");
          if(tabName === null){return;}

          openTab(tabName.innerHTML.toLowerCase());
        })
        //Open tab
        function openTab(tab = "recipeImage")
        {
          if(tab === "discover"){
            RandomRecipes();
            $("#NoFind").addClass("hidden")
          }
          if(tab === "search" && document.querySelector(".search")) $("#NoFind").addClass("hidden")
          else if(tab === "search") $("#NoFind").removeClass("hidden")

          document.querySelectorAll(".recipeImage").forEach(i => { i.classList.add("hidden")});
          document.querySelectorAll("."+tab).forEach(i => { i.classList.remove("hidden")});

          titleCheck(tab+"Tab");
        }
        //Set open tab
        function setTab(tab = "discoverTab")
        {
          $(`.mdc-tab`).removeClass("mdc-tab--active")
          $(`.mdc-tab`).prop("style","")
          $(".mdc-tab-indicator").removeClass("mdc-tab-indicator--active")
          $(`#${tab}`).addClass("mdc-tab--active")
          $(`#${tab}`).prop("style","--mdc-ripple-fg-size: 581px; --mdc-ripple-fg-scale: 1.6866410194912977; --mdc-ripple-fg-translate-start: 211.5px, -267.5px; --mdc-ripple-fg-translate-end: 193.875px, -266.5px;")
          $(`#${tab}`).find(".mdc-tab-indicator").addClass("mdc-tab-indicator--active")

          titleCheck(tab);
        }
        //Check for title
        function titleCheck(tab)
        {
          console.log(tab)
          if(tab === "discoverTab"){
            document.querySelector(".mdc-top-app-bar__title").innerHTML = "Home";
          }
          else if(tab === "searchTab"){
            if(page === "" || page === "Home"){
              document.querySelector(".mdc-top-app-bar__title").innerHTML = "Search";
            }
            else{
              document.querySelector(".mdc-top-app-bar__title").innerHTML = page;
            }
          }
        }


        //Swap Bar
        searchButt.addEventListener('click', (event) => {
          swapBar();
        });
        //Swap header top bar
        function swapBar()
        {
          searchOpen = !searchOpen
          if(searchOpen) searchButt.innerHTML = "close"
          else searchButt.innerHTML = "search"
          document.querySelector(".navBar").classList.toggle("hidden");
          document.querySelector(".searchBar").classList.toggle("hidden");
        }
        //Get recipe info
        function getInfo(id)
        {
          console.log(id)
          let spoonUrl = `https://api.spoonacular.com/recipes/${id}/information?apiKey=24c42907a88e4293a13a0cc539bf52b5`;
          $.ajax({
              url: spoonUrl,
              success: function(result){
                  let recipeCount = 0;
                  console.log(result);
                  $("#SheetTitle").text(result.title)
                  $("#SheetDescription").html(result.summary)
                  $("#SheetIngredients").empty()
                  $("#ExtraInfo").html(`${result.readyInMinutes}m prep time - ${result.servings} servings`)

                  result.extendedIngredients.forEach(element => {
                    $("#SheetIngredients").append(`<li class="whiteText">.${element.name} - ${element.amount} ${element.measures.metric.unitShort}</li>`)
                  });

                  $("#SheetInstructions").html(result.instructions)
              },
              error: function(err)
              {
                console.log(err);
              }
          })
        }
        //Connect Images to sheet
        function connectImages()
        {
          images = document.querySelectorAll('.recipeImage');
          images.forEach(i =>{
            i.addEventListener('click', (event) => {
              openSheet(event);
            });
          });
        }

        //Get recipes from search
        document.querySelector("#SearchBar").addEventListener("keyup", i => 
        {
          const code = i.key;
          if(code != "Enter") return
          
          if(sheetOpen) closeSheet()
          page = $("#SearchBar").val()
          $(".search").remove();
          swapBar()
          openTab("search")
          setTab("searchTab")
          document.querySelector(".mdc-top-app-bar__title").innerHTML = page;

          let spoonUrl = "https://api.spoonacular.com/recipes/complexSearch?apiKey=24c42907a88e4293a13a0cc539bf52b5&query=";
          spoonUrl += page;

          //Api call
          $.ajax({
              url: spoonUrl,
              success: function(result){
                  $("#NoFind").removeClass("hidden")
                  //Add Recipes
                  result.results.forEach((element) => {
                      $("#NoFind").addClass("hidden")
                      jQuery(`<div class="mdc-image-list__item recipeImage search" id="recipe${element.id}">`, {
                          id: `recipe${element.id}`,
                          class: 'mdc-image-list__item recipeImage search',
                      }).appendTo('#results');
                      $(`#recipe${element.id}`).append(`<img class="mdc-image-list__image" src="${element.image}" title="${element.title}">`);
                      $(`#recipe${element.id}`).append(`<p class="hidden">${element.id}</p>`);
                  });
                  //ConnectSheet
                  connectImages();
              },
              error: function(err)
              {
                console.log(err);
              }
              
          })
        });

        //Get random Recipes
        function RandomRecipes()
        {
          const spoonUrl = "https://api.spoonacular.com/recipes/random?apiKey=24c42907a88e4293a13a0cc539bf52b5&number=5";
          $(".discover").remove()

          //Api call
          $.ajax({
              url: spoonUrl,
              success: function(result){
                  //Add Recipes
                  result.recipes.forEach((element) => {
                      jQuery(`<div class="mdc-image-list__item recipeImage discover" id="recipe${element.id}">`, {
                          id: `recipe${element.id}`,
                          class: 'mdc-image-list__item recipeImage discover',
                      }).appendTo('#results');
                      $(`#recipe${element.id}`).append(`<img class="mdc-image-list__image" src="${element.image}" title="${element.title}">`);
                      $(`#recipe${element.id}`).append(`<p class="hidden">${element.id}</p>`);
                  });
                  //ConnectSheet
                  connectImages();
              },
              error: function(err)
              {
                console.log(err);
              }  
          })
        };
        
        //Chat with him
        document.querySelector("#ChatInput").addEventListener("keyup", i => 
        {
          const code = i.key;
          if(code != "Enter") return

          $("#Chat").append(`<div class="message"><div class="mdc-card msgCard"><p>You: ${$("#ChatInput").val()}</p></div></div>`)
          $("#Chat").append(`<div class="messageChristof"><div class="mdc-card msgCard"><p>Christof: Genoeg! jij gaat naar de bufferweek!</p></div></div>`)
          $("#ChatInput").val("")

        })
    </script>
</body>

</html>